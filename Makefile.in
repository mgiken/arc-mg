prog = arc
ver  = @PACKAGE_VERSION@

prefix      = @prefix@
exec_prefix = @exec_prefix@

srcdir = @srcdir@
bindir = @bindir@
libdir = @libdir@

arcsrc = $(srcdir)/bin/$(prog).sh
scmsrc = $(srcdir)/lib/ac.scm $(srcdir)/lib/brackets.scm
arcbin = $(srcdir)/bin/$(prog)
arclib = $(srcdir)/lib

all: $(prog)

$(prog): $(arcbin)

$(arcbin): $(arcsrc) $(scmsrc)
	mzc $(scmsrc)
	sed -e 's#ARCVER=.*#ARCVER="$(ver)"#' <$(arcsrc) | \
	sed -e 's#ARCLIB=.*#ARCLIB="$(libdir)/arc"#' >$(arcbin)
	chmod 755 $(arcbin)

clean:
	rm -rf *~ $(arcbin)

install: $(prog)
	mkdir -p $(bindir)
	cp -rTv $(arcbin) $(bindir)/$(prog)
	mkdir -p $(libdir)
	cp -rTv $(arclib) $(libdir)/$(prog)

uninstall:
	rm -rf $(bindir)/$(prog)
	rm -rf $(libdir)/$(prog)
